
```{r appendixESetUp, warning=FALSE, echo=FALSE, message=FALSE, error=FALSE}
library(knitr)
library(dplyr)
library(pander)
library(ggplot2)


    trap.count <-paste("select tp.YEAR, fe.TRIP_ID, fe.FE_MAJOR_LEVEL_ID AS SET_ID, fe.FE_SUB_LEVEL_ID AS BECKET, ", 
                       "fe.FE_MINOR_LEVEL_ID AS TRAP, SUM(c.CATCH_COUNT) AS total_count ",
                       "from dbo.GFBIO_TRAP_VW_VW AS fe INNER JOIN ",
                       "(select YEAR, TRIP_ID from dbo.SURVEY_trips_vw ",
                       " group by YEAR, TRIP_ID) AS tp ON fe.TRIP_ID = tp.TRIP_ID LEFT OUTER JOIN ",
                       " GFBioSQL.dbo.TRAP_SPECS AS ts ON fe.FISHING_EVENT_ID = ts.FISHING_EVENT_ID LEFT OUTER JOIN ",
                       " (select FISHING_EVENT_ID, SUM(CASE WHEN BAIT_LURE_CODE = 15 AND BAIT_METHOD_CODE = 4  ",
                       " then TRPBL_BAIT_AMOUNT ELSE NULL END) AS BAGGED_SQUID, SUM(CASE WHEN BAIT_LURE_CODE = 18 and  ", 
                       " BAIT_METHOD_CODE = 6 THEN TRPBL_BAIT_AMOUNT ELSE NULL END) AS LOOSE_HAKE,  ",
                       " SUM(CASE WHEN (BAIT_LURE_CODE <> 15 AND BAIT_METHOD_CODE <> 4) AND (BAIT_LURE_CODE <> 18 AND  ",
                       " BAIT_METHOD_CODE <> 6) THEN TRPBL_BAIT_AMOUNT ELSE NULL END) AS OTHER_BAIT ",
                       " from GFBioSQL.dbo.TRAP_BAIT_LURE ",
                       " group by FISHING_EVENT_ID) AS bait ON fe.FISHING_EVENT_ID = bait.FISHING_EVENT_ID  ",
                       " LEFT OUTER JOIN ",
                       " (select fec.FISHING_EVENT_ID, GFBioSQL.dbo.CATCH.SPECIES_CODE,  ",
                       " SUM(GFBioSQL.dbo.CATCH.CATCH_WEIGHT) AS CATCH_WEIGHT, SUM(GFBioSQL.dbo.CATCH.CATCH_COUNT) AS CATCH_COUNT,  ",
                       " AVG(ISNULL(GFBioSQL.dbo.CATCH.CATCH_VERIFICATION_CODE, 0)) AS VERIFICATION_METHOD ",
                       " from GFBioSQL.dbo.FISHING_EVENT_CATCH AS fec INNER JOIN ",
                       " GFBioSQL.dbo.CATCH ON fec.CATCH_ID = GFBioSQL.dbo.CATCH.CATCH_ID ",
                       " where (GFBioSQL.dbo.CATCH.SPECIES_CODE = '455') ",
                       " GROUP BY fec.FISHING_EVENT_ID, GFBioSQL.dbo.CATCH.SPECIES_CODE) AS c ON fe.FISHING_EVENT_ID = c.FISHING_EVENT_ID ",
                       " GROUP BY fe.FE_MAJOR_LEVEL_ID, fe.TRIP_ID, tp.YEAR, fe.FE_SUB_LEVEL_ID, fe.FE_MINOR_LEVEL_ID",
                       " having  (tp.YEAR IN ('",yr,"')) order by SET_ID, BECKET, TRAP",sep="")
    
   #trap.sable1   <- GetSQLData(trap.count,"Sablefish")
   #write.table(trap.sable1, file = paste(path,"appendixESetUp.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
   trap.sable1  <-  read.csv(paste(path,'appendixESetUp.csv',sep=''), header=T)


   library(tidyverse)
   library(tidyr)
   library(scales)
   
   trap.sable <- trap.sable1[,c(-1,-2,-4)] 
   #trap.sable$SET_ID <- as.factor(trap.sable$SET_ID)
   names(trap.sable) <- c("SurveySet","Trap","Value")
   trap.sable[is.na(trap.sable)] <- 0

   #  trap.sableTest  <-  trap.sable[trap.sable$SurveySet == 40,] 
   big.value <- max(trap.sable$Value)

   w<-trap.sable %>%
     group_by(SurveySet) %>%
     do({
       p <- ggplot(., aes(x = Trap, y = Value)) + 
         geom_area( fill="#6495ED", alpha=0.4) +   #6495ED
         geom_line(size = 4, color = "blue") +      
         #geom_point(size=15, color="red") + 
         ylim(0, big.value) +
         xlim(0,25) +
         theme_void() 
         #stat_summary(fun.y = max, colour = "red", geom = "point", size = 5)
         #ggsave(p, filename = paste0("fig", unique(.$SurveySet), ".png"), width = 8, height = 2)  # save time comment out
       invisible(.) 
       
     })


```
# SUMMARY OF SABLEFISH BIOLOGICAL DATA `r yr`. {#app:fifth-appendix} 
Biological data collected for sablefish by set, catch weight in kilograms and numbers of fish.  Sablefish counts by trap are represented by sparklines. Details include a tally of specimens recovered, tagged and sampled.  Mean fork lengths for tagged sablefish and sampled male and female sablefish are listed.  


```{r appendixE, echo=FALSE}

   #  Sablefish.dbo.procReport_Survey_SampleDetails pulls data 
   #  from table GFBIO_RESEARCH_SAMPLE_DETAILS, built by     
   #  procedure Sablefish.dbo.Build_BIO_Sablefish_Tables 
   # \renewcommand{\arraystretch}{1} # use above r code to stretch table

   samples           <-  paste("dbo.procReport_Survey_SampleDetails ",yr,",1,",setcnt, sep="")
   #surveyspec        <-  GetSQLData(samples,"Sablefish")
   #write.table(surveyspec, file = paste(path,'appendixE.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")  
   surveyspec        <-  read.csv(paste(path,'appendixE.csv',sep=''),header=T)
   count.row.total   <-  length(surveyspec$SET)
   count.row         <-  length(surveyspec$SET) - 1
   surveyspec$SET[count.row.total] <- "Total"
   

    i<-1
     for(i in inlet.set) {
       surveyspec[i,1] <- paste("\\color{green}{", surveyspec[i,1], "}")
     }
   
   surveyspec <-  surveyspec %>%
                  mutate(Sparkline = paste0("\\raisebox{.12\\height} {\\includegraphics[width=2cm]{fig",SET,".png}}") ) 
   
   colnames(surveyspec) <- c("", "kg","Count","Recover-Rerelease", "Deceased", "Released", 
                             "Count", "Mean", "Fork Length", "Sex","Maturity", "Otoliths",
                             "Weight","Count","Proportion Males", "Males", "Females", "Count by Trap")
   
   surveyspec <-  surveyspec[, c(1, 2, 3, 18, 4,5,6,7,8,9,10,11,12,13,14,15,16,17)]  #reorder table
   
   colnames(surveyspec) <- c("", "kg","Count","Count by Trap","Recover-Rerelease", "Deceased", "Released", 
                             "Count", "Mean", "Fork Length", "Sex","Maturity", "Otoliths",
                             "Weight","Count","Proportion Males", "Males", "Females" )

   kableExtra::kable(surveyspec,
                     booktabs = TRUE,     
                     longtable = T,
                     escape = F,        # lets the image show up 
                     linesep   = "",
                     align=rep('r', 18),
                     format = "latex") %>%
      
   add_header_above(c("Set"= 1,
                      "Total Catch" = 3, 
                      "Tagged Fish Counts" = 3,  
                      "Tagged Fork Lengths(mm)" = 2,
                      "Specimen Count"= 6, 
                      "Mean Fork Length(mm)" = 3), bold = TRUE) %>%
      
   kableExtra::kable_styling(font_size = 8, 
                     latex_options = "repeat_header",
                     repeat_header_text = "continued.", 
                     repeat_header_method = "replace") %>%     
   
   kableExtra::landscape()  %>%
   row_spec(0, bold = T)  %>%   
   column_spec(1,width    = "0.3cm") %>%  # set
   column_spec(2,width    = "0.6cm") %>%  # kg
   column_spec(3,width    = "0.7cm") %>%  # count
   column_spec(4,width    = "1.4cm") %>%  # sparkline      
   column_spec(5,width    = "0.9cm") %>%  # rr
   column_spec(6,width    = "1.0cm") %>%  # decease
   column_spec(7,width    = "0.9cm") %>%  # rel     
   column_spec(8,width    = "1.5cm") %>%  # count
   column_spec(9,width    = "0.9cm") %>%  # mean
   column_spec(10,width   = "0.5cm") %>%  # fl
   column_spec(11,width   = "0.5cm") %>%  # sex
   column_spec(12,width   = "0.7cm") %>%  # mat
   column_spec(13,width   = "0.7cm") %>%  # oto 
   column_spec(14,width   = "0.6cm") %>%  # wt
   column_spec(15,width   = "0.6cm") %>%  # cnt
   column_spec(16,width   = "1.1cm") %>%  # prop m
   column_spec(17,width   = "0.7cm") %>%  # male         
   column_spec(18,width   = "0.7cm") %>%  # fem
   row_spec(count.row.total, bold = T)  %>%    
   row_spec(count.row,  hline_after = T)

```
\clearpage






# SUMMARY OF BIOLOGICAL DATA FOR ROUGHEYE/BLACKSPOTTED ROCKFISH COMPLEX. {#app:sixth-appendix} 
Biological data collected for rougheye/blackspotted rockfish complex.  Each set is listed with counts of specimens sampled, calculations of mean fork lengths and number of species visually identified as either a RE = rougheye rockfish, BS = blackspotted rockfish or a hybrid.

```{r appendixF, echo=FALSE}
 
   othersamples <-  paste( "select species_name, [SET], [Len Sample Count], ",
                           "[weight_count], [Sex Sample Count], ",
                           "[Maturity Sample Count], [Otolith Sample Count], [DNA Sample Count], ",
                           "Sample_count, [Proportion Males],  ",   
                           "round([Male Mean Fork Len(mm)],0) as malelen, ",
                           "round([Female Mean Fork Len(mm)],0) as femlen,  ", 
                           "round([NoSexMeanLen(mm)],0) as nosexlen, ", 
                           "bsre.Rougheye, bsre.Blackspotted, bsre.Hybrid ",
                           "from  ",
                           "(select year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, ",
                           "SUM(re) AS Rougheye, SUM(bs) AS Blackspotted, SUM(hyb) AS Hybrid ",
                           "from  (select year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, ",
                           "CASE WHEN EXISTENCE_ATTRIBUTE_CODE = 16 THEN 1 ELSE 0 END AS re, ",
                           "CASE WHEN EXISTENCE_ATTRIBUTE_CODE = 17 THEN 1 ELSE 0 END AS bs, ",
                           "CASE WHEN EXISTENCE_ATTRIBUTE_CODE = 31 THEN 1 ELSE 0 END AS hyb, ",
                           "SPECIMEN_ID ",
                           "from dbo.gfbio_species_guess) AS bs ",
                           "group by year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE) AS bsre ", 
                           "RIGHT OUTER JOIN ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH ON bsre.TRIP_ID = ",              
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.TRIP_ID and ",
                           "bsre.FE_MAJOR_LEVEL_ID = dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET] ",
                           "and bsre.SPECIES_CODE = ",                       
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species ",            
                           "where (dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Year = ",yr, 
                           "and (species_name='ROUGHEYE/BLACKSPOTTED ROCKFISH COMPLEX')) order by species,[SET]", sep="")
   #otherspec2            <-  GetSQLData(othersamples,"Sablefish")   # read from SQL Server
   #write.table(otherspec2, file = paste(path,'appendixF.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   otherspec2            <-  read.csv(paste(path,'appendixF.csv',sep=''),header=T) # read from csv
   otherspec2$species_name<-as.character(otherspec2$species_name)
   addition              <-  c('Total','', sum(otherspec2$Len.Sample.Count),    sum(otherspec2$weight_count), 
                                           sum(otherspec2$Sex.Sample.Count),    sum(otherspec2$Maturity.Sample.Count),   
                                           sum(otherspec2$Otolith.Sample.Count),sum(otherspec2$DNA.Sample.Count),
                                           sum(otherspec2$Sample_count),'','','','',
                                           sum(otherspec2$Rougheye),sum(otherspec2$Blackspotted),sum(otherspec2$Hybrid))
   otherspec             <-  rbind(otherspec2,addition)
   row.count             <-  length(otherspec$species_name)
  
   otherspec$species_name<-  cleanf(otherspec$species_name)    # only rougheye/blackspotted sampled in 2020
   colnames(otherspec)   <-  c("Species Name", "Set", "Fork Length",
                               "Weight", "Sex","Maturity", "Otolith", 
                               "DNA", "Total Count", 
                               "Proportion Males", "Males", "Females",  
                               "No sex", "RE", "BS","Hybrid" )
   
      kableExtra::kable(otherspec,
                     booktabs = TRUE, 
                     longtable = T,
                     linesep   = "",
                     align=c('l', 'r','c','c','c','c','c','c','c','c','c','c','c','c','c','c'),
                     format = "latex") %>%
      
      add_header_above(c(" "= 2,
                      "Specimen Count"= 7, 
                      "Mean Fork Length(mm)" = 4,
                      "Sampler Visual id Count" = 3), bold=TRUE) %>%
   
      kableExtra::kable_styling(font_size = 8, 
                        latex_options = "repeat_header",
                        repeat_header_text = "continued.", 
                        repeat_header_method = "replace") %>%
      
      kableExtra::landscape()  %>% 
         
      column_spec(1,width     = "3.5cm") %>% # species
      column_spec(2,width     = "0.7cm") %>% # set
      column_spec(3,width     = "0.7cm") %>% # fl 
      column_spec(4,width     = "0.7cm") %>% # wt   
      column_spec(5,width     = "0.7cm") %>% # sex 
      column_spec(6,width     = "0.7cm") %>% # mat
      column_spec(7,width     = "0.7cm") %>% # oto
      column_spec(8,width     = "0.7cm") %>% # dna
      column_spec(9,width     = "0.7cm") %>% # cnt        
      column_spec(10,width    = "1.1cm") %>% # prop m
      column_spec(11,width    = "0.7cm") %>% # male
      column_spec(12,width    = "0.7cm") %>% # female
      column_spec(13,width    = "0.7cm") %>% #  no sex  
      column_spec(14,width    = "1.0cm") %>% # re
      column_spec(15,width    = "1.2cm") %>% # bc
      column_spec(16,width    = "0.8cm") %>% # hybrid 
      row_spec(0, bold = T) %>%
      row_spec(row.count-1,  hline_after = T) %>%
      row_spec(row.count, bold = T)

```
\clearpage


# SUMMARY OF BIOLOGICAL DATA FOR ALL OTHER SPECIES. {#app:seventh-appendix} 
Biological data collected for species other than sablefish or rougheye/blackspotted rockfish complex.  Each set is listed with counts of specimens sampled, and calculations of mean fork lengths (mm).

```{r appendixG, echo=FALSE}
 
   othersamples <-  paste( "select dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.MORPHOMETRICS_ATTRIBUTE_DESC AS Length_type, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET], dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Len Sample Count], ",                 
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.weight_count, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Sex Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Maturity Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Otolith Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[DNA Sample Count], ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Sample_count,  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Proportion Males],   ",
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Male Mean Fork Len(mm)], 0) AS malelen,    ",      
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Female Mean Fork Len(mm)], 0) AS femlen,    ",
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[NoSexMeanLen(mm)], 0) AS nosexlen   ",
                           "from dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH LEFT OUTER JOIN   ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE ON dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Year =   ",             
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.year and    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.TRIP_ID = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.trip_id AND    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET] = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.fe_major_level_id and    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.species_code   ",
                           "where (dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Year = 2012) and  ",      
                           "(dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.MORPHOMETRICS_ATTRIBUTE_DESC = 'FORK LENGTH') and ",
                           "(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name <> 'ROUGHEYE/BLACKSPOTTED ROCKFISH COMPLEX') ",
                           "order by dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name, dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET]", sep="")
   #otherspec              <-  GetSQLData(othersamples,"Sablefish")   # read from SQL Server
   #write.table(otherspec, file = paste(path,'appendixG.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   otherspec              <-  read.csv(paste(path,'appendixG.csv', sep=''),  header=T) # read from csv
   otherspec <-  otherspec[,c(-2,-5,-7,-8,-9)]
   row.count              <-  length(otherspec$species_name)
  
   otherspec$species_name<-  cleanf(otherspec$species_name)  
   #otherspec$Length_type <-  cleanf(otherspec$Length_type)
   colnames(otherspec)   <-  c("Species Name", "Set", "Fork Length",
                                "Sex", "Total Count", 
                               "Proportion Males", "Males", "Females",  
                               "No sex")
   
      kableExtra::kable(otherspec,
                     booktabs = TRUE, 
                     longtable = T,
                     linesep   = "",
                     align=c('l', 'l','r','c','c','c','c','c','c'),
                     format = "latex") %>%
      
      add_header_above(c(" "= 3,
                      "Specimen Count"= 3, 
                      "Mean Fork Length(mm)" = 4), bold=TRUE) %>%
   
      kableExtra::kable_styling(font_size = 8, 
                        latex_options = "repeat_header",
                        repeat_header_text = "continued.", 
                        repeat_header_method = "replace") %>%
      

      column_spec(1,width     = "3.0cm") %>% # species
      column_spec(2,width     = "0.7cm") %>% # length type          
      column_spec(3,width     = "0.7cm") %>% # set
      column_spec(4,width     = "0.7cm") %>% # fl 
      column_spec(5,width     = "0.7cm") %>% # sex 
      column_spec(6,width     = "1.2cm") %>% # cnt        
      column_spec(7,width     = "1.1cm") %>% # prop m
      column_spec(8,width     = "0.7cm") %>% # male
      column_spec(9,width     = "0.7cm") %>% # female

      row_spec(0, bold = T) %>%
      row_spec(60,  hline_after = T)  %>%
      row_spec(62,  hline_after = T)  %>%
      row_spec(64,  hline_after = T)  %>%
      row_spec(65,  hline_after = T)  %>%    
      row_spec(69,  hline_after = T)  %>%    
      row_spec(79,  hline_after = T)  %>%
      row_spec(114,  hline_after = T)  %>%    
      row_spec(118,  hline_after = T)  %>% 
      row_spec(136,  hline_after = T)  %>% 
      row_spec(138,  hline_after = T)  %>%         
      row_spec(144,  hline_after = T)            
```
\clearpage

# SUMMARY OF BIOLOGICAL DATA FOR ALL OTHER SPECIES. {#app:eighth-appendix} 
Biological data collected for species with measurement of length type other than fork length.  Each set is listed with counts of specimens sampled and length type measured.

```{r appendixH, echo=FALSE}
 
   othersamples <-  paste( "select dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.MORPHOMETRICS_ATTRIBUTE_DESC AS Length_type, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET], dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Len Sample Count], ",                 
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.weight_count, ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Sex Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Maturity Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Otolith Sample Count],  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[DNA Sample Count], ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Sample_count,  ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Proportion Males],   ",
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Male Mean Fork Len(mm)], 0) AS malelen,    ",      
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[Female Mean Fork Len(mm)], 0) AS femlen,    ",
                           "ROUND(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[NoSexMeanLen(mm)], 0) AS nosexlen   ",
                           "from dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH LEFT OUTER JOIN   ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE ON dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Year =   ",             
                           "dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.year and    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.TRIP_ID = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.trip_id AND    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET] = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.fe_major_level_id and    ",
                           "dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species = dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.species_code   ",
                           "where (dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.Year = 2012) and  ",      
                           "(dbo.GFBIO_RESEARCH_SAMPLE_OTHER_FISH_LENGTH_TYPE.MORPHOMETRICS_ATTRIBUTE_DESC not in('FORK LENGTH', 'PRE-CAUDAL LENGTH')) and ",
                           "(dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name <> 'ROUGHEYE/BLACKSPOTTED ROCKFISH COMPLEX') ",
                           "order by dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.species_name, dbo.GFBIO_RESEARCH_SAMPLE_DETAILS_OTHER_FISH.[SET]", sep="")
   #otherspec              <-  GetSQLData(othersamples,"Sablefish")   # read from SQL Server
   #write.table(otherspec, file = paste(path,'appendixH.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   otherspec              <-  read.csv(paste(path,'appendixH.csv', sep=''),  header=T) # read from csv
   otherspec <-  otherspec[,c(-5,-7,-8,-9,-12,-13,-14)]
 
   otherspec$Length_type    <- gsub('TOTAL LENGTH', 'Total', otherspec$Length_type)
   otherspec$Length_type    <- gsub('SNOUT TO ANAL FIN LENGTH', 'Snout to anal fin', otherspec$Length_type)
   otherspec$Length_type    <- gsub('PRE-CAUDAL LENGTH', 'Pre-caudal', otherspec$Length_type)  
   otherspec$Length_type    <- gsub('SNOUT TO ANAL FIN LENGTH', 'Snout to anal fin length', otherspec$Length_type)  
   otherspec$species_name<-  cleanf(otherspec$species_name)  
      
   colnames(otherspec)   <-  c("Species Name", "Length Type", "Set", "Length",
                               "Sex", "Total Count", "Proportion Males")
     kableExtra::kable(otherspec,
                     booktabs = TRUE, 
                     longtable = T,
                     linesep   = "",
                     align=c('l', 'l','r','c','c','c','c'),
                     format = "latex") %>%
      
      add_header_above(c(" "= 3,
                      "Specimen Count"= 3," "= 1), bold=TRUE) %>%
   
      kableExtra::kable_styling(font_size = 8, 
                        latex_options = "repeat_header",
                        repeat_header_text = "continued.", 
                        repeat_header_method = "replace") %>%
      
      column_spec(1,width     = "4.7cm") %>% # species
      column_spec(2,width     = "2.8cm") %>% # length type          
      column_spec(3,width     = "0.7cm") %>% # set
      column_spec(4,width     = "0.7cm") %>% # fl 
      column_spec(5,width     = "0.7cm") %>% # sex 
      column_spec(6,width     = "0.7cm") %>% # count
      column_spec(7,width     = "0.8cm") %>% # propmales       

      row_spec(0, bold = T) %>%
      row_spec(12,  hline_after = T)  %>%
      row_spec(13,  hline_after = T)  %>% 
      row_spec(40,  hline_after = T)  %>% 
      row_spec(48,  hline_after = T)  %>% 
      row_spec(100,  hline_after = T)  %>%
      row_spec(109,  hline_after = T)  %>%  
      row_spec(137,  hline_after = T)  %>%         
      row_spec(139,  hline_after = T)     
         
   


```
\clearpage
# POP-OFF SATELLITE TAGGING INSTRUCTIONS FOR SPINY DOGFISH FROM AUKE BAY LABORATORY. {#app:nineth-appendix} 
Biological data collected for species with measurement of length type other than fork length.  Each set is listed with counts of specimens sampled and length type measured.

```{r AppendixI,out.width = "470px", out.height = "489px", fig.align="left"}

      if(knitr:::is_latex_output())
         # paper tagging sheet
         img <-  paste(basepath,'AppendixC9a_spinyDogfish.png',sep="")
      knitr::include_graphics(img) 
         img <-  paste(basepath,'AppendixC9b_spinyDogfish.png',sep="")
      knitr::include_graphics(img)

```
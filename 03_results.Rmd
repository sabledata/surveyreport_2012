# Results and Discussion

## FISHING

The `r yr` survey was 40 days long, beginning in Victoria, BC on October 9, with crew changes on October 20 at Coal Harbour, October 29 at Rose Harbour and November 11 at Prince Rupert.  In total, 135 sets were completed: 110 StRS sets, 3 camera sets, 2 exploratory sets and 20 standardized sets at mainland inlets.


```{r CatchRateText, echo=FALSE}
  # -- generate the lowest uncertainity and corresponding year for catch rate paragraph

  dtStRS   <-   " select  * from dbo.GENERIC_GFBIO_TRAPS order by year"  # -- must update view GENERIC_GFBIO_TRAPS
  #datStRS  <-   GetSQLData(dtStRS,"Sablefish")                          # read from SQL Server
  #write.table(datStRS, file = paste(path,"results01.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")  
  datStRS  <-  read.csv(paste(path,'results01.csv',sep=''), header=T)  # read from csv
  odbcCloseAll()

  datRD    <-   datStRS[ datStRS$SABLE.SET.TYPE=="StRS", ] # --  pick out the random sets
  dat      <-   datRD[ ! is.na(datRD$SABLE.SET.TYPE), ]
  yrs      <-   unique(datRD$year)   # -- get unique years
  nyrs     <-   length(yrs)
  
  data.cv  <- data.frame( year   <- numeric(),
                          value1 <- numeric(),
                          value2 <- numeric(),
                          value3 <- numeric() )
  
  data.mn <- data.frame(  year   <- numeric(),
                          value1 <- numeric(),
                          value2 <- numeric(),
                          value3 <- numeric() )

  # -- iterate through the years building depth boxplots to get cv's and mean counts
  for (i in 1:nyrs)
     {    yrdat          <- datRD[datRD$year==yrs[i],]      # -- get the year dataset
          bxdat          <- split(yrdat$CPUE.SABLE.COUNT / yrdat$CPUE.TRAPS, as.character(yrdat$SABLE.DEPTH.GROUP))  # split by depth
          dpth.mean      <- sapply(bxdat, mean, na.rm=T)    # -- add the mean by depth  points
          std.dev        <- sapply(bxdat, sd, na.rm=T)
          names(data.cv) <- c("year", "RD1", "RD2", "RD3")  # -- store cv's
          names(data.mn) <- c("year", "RD1", "RD2", "RD3")  # -- store mean counts by depth
          data.cv        <- rbind(data.cv,c(yrs[i],round(std.dev/dpth.mean,2)))
          data.mn        <- rbind(data.mn,c(yrs[i],round(dpth.mean,0)))
      }
  
          RD1.cvlow      <- min(data.cv$RD1)
          RD1.cvlowyr    <- data.cv$year[data.cv$RD1==RD1.cvlow]
          RD2.cvlow      <- min(data.cv$RD2)
          RD2.cvlowyr    <- data.cv$year[data.cv$RD2==RD2.cvlow]
          RD3.cvlow      <- min(data.cv$RD3)
          RD3.cvlowyr    <- data.cv$year[data.cv$RD3==RD3.cvlow]
          
    # -- type data.mn in the Console to view the shallow, middle and deep depth stratums CPUE for 
    # -- descriptive paragraph below
  
```
## CATCH PER UNIT EFFORT (CPUE) 

### StRS CPUE

In general, catch per unit effort as indexed by kilograms (Figure \@ref(fig:figure6)) and numbers (Figure \@ref(fig:figure7)) of sablefish per trap, attained the highest catch rates in the middle depth stratum (RD~2~) in most years.  

The average weight of sablefish over time in the deep depths (RD~3~) tended to be higher in the northern survey areas. In the middle (RD~2~) and shallow waters (RD~1~) the mean weights were consistently higher in area S~4~ (Figure \@ref(fig:figure8)).  

CPUE over the survey years (2003 to 2012) reached over 26 kg/trap and over 9 fish/trap during 2003, 2005, 2006 and 2008. In 2012, the catch rate dropped to the lowest levels since 2003 (Figure \@ref(fig:figure9),a,b). The average weight of sablefish remained close to 3 kg over time (Figure \@ref(fig:figure9),c).

### Mainland Inlet CPUE

CPUE in the mainlaind inlets has  varied in a relatively predictable manner over time with peak CPUE occuring every 5-7 years. In the early part of the time series (mid-1990s) average CPUE remained relatively constant before a peak in CPUE was observed in 1999, followed by declines to consistent levels until another peak in 2003 and 2004, and again in 2011.  In 2012, CPUE (kg/trap) dropped to levels similar to 2010 (Figure \@ref(fig:figure10) a,b). Annual mean weights of sablefish in 2012 were 0.5 kg less than those at StRS sites (Figure \@ref(fig:figure10) c).


```{r SpeciesCompositionText, echo=FALSE}
  # -- taxonomic top 5 group count StRS
   topStRS      <- paste("select top (5) SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME, ",
                         "sum(CATCH_WEIGHT) AS catchkg ",
                         "from dbo.GFBIO_RESEARCH_CATCH ",
                         "group by SABLE_SET_TYPE, Year, SPECIES_CODE, ",
                         "SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME ",
                         "having (SABLE_SET_TYPE = N'StRS') and ",
                         "(SPECIES_CODE <> N'455') and (Year = ", yr ,") ",
                         "order by catchkg DESC", sep="") 
   #topStRSsp    <- GetSQLData(topStRS,"Sablefish") 
   #write.table(topStRSsp, file = paste(path,"results02.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   topStRSsp  <-  read.csv(paste(path, 'results02.csv', sep=''), header=T) 
   
   topStRSsp1   <- as.character(topStRSsp[1,1])                     # -- StRS top 5 species names
   topStRSsc1   <- firstup(tolower(as.character(topStRSsp[1,2])))   # -- StRS top 5 species science names
   
   topStRSsp2   <- as.character(topStRSsp[2,1])                       
   topStRSsc2   <- firstup(tolower(as.character(topStRSsp[2,2])))   
   
   topStRSsp3   <- tolower(as.character(topStRSsp[3,1]))                      
   topStRSsc3   <- firstup(tolower(as.character(topStRSsp[3,2])))
   topStRSsc3   <- gsub("Sebastes aleutianus","Sebastes aleutianus/melanostictus", topStRSsc3) 
   
   topStRSsp4   <- tolower(as.character(topStRSsp[4,1]) )                    
   topStRSsc4   <- firstup(tolower(as.character(topStRSsp[4,2])))
   topStRSsc4   <- gsub("Sebastes aleutianus","Sebastes aleutianus/melanostictus", topStRSsc4)    
   
   topStRSsp5   <- tolower(as.character(topStRSsp[5,1]))                      
   topStRSsc5   <- firstup(tolower(as.character(topStRSsp[5,2]))) 

 
 # -- species composition counts for StRS sets 
   spc          <- paste("select dbo.fnIntegerToWords(sum(CAST(Roundfish as int))) as tRound,  ",
                                "dbo.fnIntegerToWords(sum(Rockfish))     as tRock,   ",
                                "dbo.fnIntegerToWords(sum(Flatfish))     as tFlat,   ",
                                "dbo.fnIntegerToWords(sum(Invertebrate)) as tInvert, ",
                                "dbo.fnIntegerToWords(sum(Mammal))       as tMammal, ",
                                "dbo.fnIntegerToWords(sum(Bird))         as tBird,   ",
                                "dbo.fnIntegerToWords(sum(counter))      as total    ",
                                "from (select case when Fish = Rockfish or Fish = Flatfish ", 
                                "then 0 ELSE Fish end AS Roundfish, ",
                                "Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird, ",
                                "SABLE_SET_TYPE, TRIP_ID, 1 AS counter, Year, ",
                                "SPECIES_CODE from dbo.GFBIO_RESEARCH_CATCH ",
                                "group by ",
                                "Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird, ",
                                "SABLE_SET_TYPE, Year, TRIP_ID,  ",
                                "case when Fish = Rockfish or Fish = Flatfish then 0 ELSE Fish end, SPECIES_CODE  ",
                                "having (SABLE_SET_TYPE = N'StRS') and (Year = ",yr,")) AS RC", sep="")
   #strsSpCom    <- GetSQLData(spc,"Sablefish")
   #write.table(strsSpCom, file = paste(path,"results03.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   strsSpCom   <-  read.csv(paste(path,'results03.csv',sep=''),header=T) 
   
   roundfishS   <- strsSpCom[1,1]    # number of roundfish
   rockfishS    <- strsSpCom[1,2]    # number of rockfish
   flatfishS    <- strsSpCom[1,3]    # number of invertebrates
   invertS      <- strsSpCom[1,4]
   mammalS      <- strsSpCom[1,5]
   birdS        <- strsSpCom[1,6]
   totalS       <- firstup(as.character(strsSpCom[1,7])) # taxonomic unit count for StRS with capital
   totalS       <- as.character(strsSpCom[1,7]) # taxonomic unit count for StRS
   
   
   
  # -- taxonomic group count Inlets 
   topInlet     <- paste("select top (2) SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME, sum(CATCH_WEIGHT) AS catchkg ",
                           "from dbo.GFBIO_RESEARCH_CATCH  ",
                           "group by SABLE_SET_TYPE, Year, SPECIES_CODE, SPECIES_COMMON_NAME, SPECIES_SCIENCE_NAME ",
                           "having (SABLE_SET_TYPE = N'INLET STandARDIZED') ",
                           "and (SPECIES_CODE <> N'455') and (Year = ",yr,") ",
                           "order by catchkg DESC", sep="") 
   #topInletsp   <- GetSQLData(topInlet,"Sablefish") 
   #write.table(topInletsp, file = paste(path,"results03Inlet.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")    
   topInletsp   <-  read.csv(paste(path,'results03Inlet.csv',sep=''),header=T)
      
   topInletsp1  <- as.character(topInletsp[1,1])                    # -- inlet top 2 species names
   topInletsc1  <- firstup(tolower(as.character(topInletsp[1,2])))  # -- inlet top 2 species science names
   
   topInletsp2  <- tolower(as.character(as.character(topInletsp[2,1])))  # -- put to lowercase
   topInletsc2  <- firstup(tolower(as.character(topInletsp[2,2])))  
   
   # -- species composition counts inlet sets
   spcI          <- paste("select dbo.fnIntegerToWords(SUM(CAST(Roundfish AS int))) AS tRound, ",
                                 "dbo.fnIntegerToWords(ISNULL(SUM(Rockfish),0))     AS tRock,    ",
                                 "dbo.fnIntegerToWords(ISNULL(SUM(Flatfish),0))     AS tFlat,    ",
                                 "dbo.fnIntegerToWords(ISNULL(SUM(Invertebrate),0)) AS tInvert,  ",
                                 "dbo.fnIntegerToWords(ISNULL(SUM(Mammal),0))       AS tMammal,  ",
                                 "dbo.fnIntegerToWords(ISNULL(SUM(Bird),0))         AS tBird,    ",
                                 "dbo.fnIntegerToWords(SUM(counter))                AS total     ",    
                                 "from   (select CASE WHEN Fish = Rockfish or Fish = Flatfish ",
                                 "then 0 ELSE Fish END AS Roundfish,  ",
                                 "Fish, Rockfish, Flatfish, Invertebrate, Mammal, Bird,       ",
                                 "SABLE_SET_TYPE, TRIP_ID, 1 AS counter, Year, SPECIES_CODE   ",
                                 "from dbo.GFBIO_RESEARCH_CATCH  ",
                                 "group by Fish, Rockfish, Flatfish, Invertebrate, Mammal, ",
                                 "Bird, SABLE_SET_TYPE, Year, TRIP_ID, ",
                                 "CASE WHEN Fish = Rockfish or Fish = Flatfish THEN 0 ELSE Fish END, SPECIES_CODE ",
                                 "having (SABLE_SET_TYPE = N'INLET STANDARDIZED')       ",
                                 "and (Year = ",yr,")) AS RC", sep="")
   #strsSpComI    <- GetSQLData(spcI,"Sablefish")
   #write.table(strsSpComI, file = paste(path,"results04I.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")    
   strsSpComI   <-  read.csv(paste(path,'results04I.csv',sep=''),header=T) 
   
   roundfishI   <- strsSpComI[1,1]
   rockfishI    <- strsSpComI[1,2]
   flatfishI    <- strsSpComI[1,3]
   invertI      <- strsSpComI[1,4]
   #mammalI      <- strsSpComI[1,5]
   #birdI        <- strsSpComI[1,6]
   totalI       <- firstup(as.character(strsSpComI[1,7]))   # taxonomic units count for inlets
   totalI       <- as.character(strsSpComI[1,7])      # taxonomic units count for inlets


```

## CATCH COMPOSITION

A total of `r totalS[1]` taxonomic groups were represented in the catches in StRS sets in `r yr`.  These included `r roundfishS[1]` roundfish species, `r rockfishS[1]` rockfish species, `r flatfishS[1]`  flatfish species and `r invertS[1]` invertebrate species. Other than sablefish, the most common species, by weight,  were  `r topStRSsp1[1]` (*`r topStRSsc1`*), `r topStRSsp2` (*`r topStRSsc2`*), `r topStRSsp3` (*`r topStRSsc3`*),   `r topStRSsp4` (*`r topStRSsc4`*) and  `r topStRSsp5` (*`r topStRSsc5`*) (Table \@ref(tab:table3)).

A total of `r totalI` taxonomic groups were represented in the catches from traditional standardized sets conducted in mainland inlet localities in `r yr`.  These included `r roundfishI` roundfish species, `r rockfishI`  rockfish species, `r flatfishI` flatfish species and `r invertI` invertebrate species.  The most common species, by weight, other than sablefish were `r topInletsp1` (*`r topInletsc1`*) and `r topInletsp2` (*`r topInletsc2`*) (Table \@ref(tab:table4)).

Two taxonomic groups were represented in the catches at the exploratory sites in `r yr`.  Only one sablefish (*Anoplopoma fimbria*) and one Pacific ocean perch (*Sebastes alutus*) were captured (Table \@ref(tab:table5)).

```{r SamplingWords, echo=FALSE}
    # inline text query Sablefish.dbo.GFBIO_RESEARCH_SAMPLE_DETAILS for the counts of Sablefish from StRS sets
    catchStRS   <- paste("select rt.SABLE_SET_TYPE, ",
                         "sum(sd.[Total Count])                           AS count, ",
                         "sum(sd.[Recovered Number])                      AS tagagainlive, ",
                         "sum(sd.[Recovered Dead Number])                 AS tagdead, ",
                         "sum(sd.[Tagged Number] + sd.[Recovered Number]) AS tagrelease, " ,
                         "sum(sd.[Fork Len Tag Sample Count])             AS taglengthsample,  " ,
                         "sum(sd.Sample_count)                            AS samplecount " ,
                         "from dbo.GFBIO_RESEARCH_SAMPLE_DETAILS AS sd INNER JOIN " ,         
                         "dbo.GFBIO_SABLEBIO_TRIP_SET AS rt ON " ,
                         "sd.TRIP_ID = rt.TRIP_ID AND  sd.[SET] = rt.SET_NUMBER " ,
                         "where (sd.Year =", yr,") group by rt.SABLE_SET_TYPE",sep="")
    countStRS   <- GetSQLData(catchStRS,"Sablefish")
    write.table(countStRS, file = paste(path,"results04.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    countStRS   <-  read.csv(paste(path,'results04.csv',sep=''),header=T) 
    
    # -- Sablefish.dbo.procReport_Survey_LenMF pulls length data from table GFBIO_SABLEBIO_VW 
    # -- from procedure Build_BIO_Sablefish_Tables for the histogram of lengths
    
    lendat     <-   "exec procReport_Survey_LenMF"
    #lendata    <-   GetSQLData(lendat,"Sablefish")
    #write.table(lendata, file = paste(path,"results05.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    lendata   <-    read.csv(paste(path,'results05.csv',sep=''),header=T) 

    # late addition for the average lengths per year in text
    lenstats  <- "exec procRReport_Survey_LenAvg"
    #dat       <- GetSQLData(lenstats,"Sablefish")
    #write.table(dat, file = paste(path,'results05b.csv',sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    dat       <- read.csv(paste(path,'results05b.csv',sep=''), header=T)
    
    mavgyr1   <- dat[dat$sex==1 & dat$YEAR==yr,]   # round(mavgyr1$AvL,1)
    favgyr1   <- dat[dat$sex==2 & dat$YEAR==yr,]   # round(favgyr1$AvL,1)
  
    fdat      <- dat[dat$sex==2,]
    mdat      <- dat[dat$sex==1,]
    
    firstyrfem <-   lendata[lendata$year == yr & lendata$sex == 2,] 
    firstyrmal <-   lendata[lendata$year == yr & lendata$sex == 1,] 
      
    lenMF      <-   lendata[lendata$year <= yr,] 
    brk        <-   seq(min(lenMF$length)-1,max(lenMF$length)+1)
    osex       <-   length(lenMF$length[lenMF$sex==3])
    	
    # -- set up the female data
    females  <-   lenMF$length[lenMF$sex==2]
    females  <-   females[!is.na(females)]
    tf       <-   length(females)                                 # -- count female lengths
    mLf      <-   format(round(mean(females,na.rm=T),1),nsmall=1) # -- mean female length
    stdf     <-   round(sd(females),1)                            # -- standard deviation
    	
    #--  set up the male data
    males    <-   lenMF$length[lenMF$sex==1]
    tm       <-   length(males)                                   # -- count male lengths
    mLm      <-   format(round(mean(males,na.rm=T),1),nsmall=1)   # -- mean male length
    stdm     <-   round(sd(males),1)                              # -- standard deviation
 
    # --  StRS year one by spatial and depth strata:  count/mean of samples for fork length and tagged fish fork lengths
     bio      <-   paste("select locality, depth, PropMales, PropFemales, ",
                         "MalesMnFkLen, FemalesMnFkLen, TaggedMnFkLen ",
                         "from gfbio_sable_bio_summary ",
                         "where depth is not null and year = ",yr,
                         "order by Locality,Depth", sep="")
     #biosumm  <-   GetSQLData(bio,"Sablefish")
     #write.table(biosumm, file = paste(path,"results06.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
     biosumm   <-    read.csv(paste(path,'results06.csv',sep=''),header=T) 

     colnames(biosumm) <-  c("Spatial","Depth","Males","Females","Males","Females","Tagged")
     biosumm$Spatial   <-  cleanf(biosumm$Spatial)  # use the remove duplicates function

     #  -- sum the count of length values for the table columns
     biosumm[16,3]     <-  round((biosumm[1,3] + biosumm[2,3] + biosumm[3,3])/ 3, 2)  # --  males S1 average proportions
     biosumm[16,4]     <-  round((biosumm[1,4] + biosumm[2,4] + biosumm[3,4])/ 3, 2)  # --  females S1 average proportions
     biosumm[16,5]     <-  round((biosumm[1,5] + biosumm[2,5] + biosumm[3,5])/ 3, 0)  # --  males S1 average fork len
     biosumm[16,6]     <-  round((biosumm[1,6] + biosumm[2,6] + biosumm[3,6])/ 3, 0)  # --  females S1 average fork len 
     biosumm[16,7]     <-  round((biosumm[1,7] + biosumm[2,7] + biosumm[3,7])/ 3, 0)  # --  tagged S1 average fork len
      
     biosumm[17,3]     <-  round((biosumm[4,3] + biosumm[5,3] + biosumm[6,3])/ 3, 2)   # -- S2
     biosumm[17,4]     <-  round((biosumm[4,4] + biosumm[5,4] + biosumm[6,4])/ 3, 2)
     biosumm[17,5]     <-  round((biosumm[4,5] + biosumm[5,5] + biosumm[6,5])/ 3, 0)
     biosumm[17,6]     <-  round((biosumm[4,6] + biosumm[5,6] + biosumm[6,6])/ 3, 0)
     biosumm[17,7]     <-  round((biosumm[4,7] + biosumm[5,7] + biosumm[6,7])/ 3, 0)
      
     biosumm[18,3]     <-  round((biosumm[7,3] + biosumm[8,3] + biosumm[9,3])/ 3, 2)   # -- S3
     biosumm[18,4]     <-  round((biosumm[7,4] + biosumm[8,4] + biosumm[9,4])/ 3, 2)
     biosumm[18,5]     <-  round((biosumm[7,5] + biosumm[8,5] + biosumm[9,5])/ 3, 0)
     biosumm[18,6]     <-  round((biosumm[7,6] + biosumm[8,6] + biosumm[9,6])/ 3, 0)
     biosumm[18,7]     <-  round((biosumm[7,7] + biosumm[8,7] + biosumm[9,7])/ 3, 0)
      
     biosumm[19,3]     <-  round((biosumm[10,3] + biosumm[11,3] + biosumm[12,3])/ 3, 2)  # -- S4
     biosumm[19,4]     <-  round((biosumm[10,4] + biosumm[11,4] + biosumm[12,4])/ 3, 2)
     biosumm[19,5]     <-  round((biosumm[10,5] + biosumm[11,5] + biosumm[12,5])/ 3, 0)
     biosumm[19,6]     <-  round((biosumm[10,6] + biosumm[11,6] + biosumm[12,6])/ 3, 0) 
     biosumm[19,7]     <-  round((biosumm[10,7] + biosumm[11,7] + biosumm[12,7])/ 3, 0) 
      
     biosumm[20,3]     <-  round((biosumm[13,3] + biosumm[14,3] + biosumm[15,3])/ 3, 2)  # --S5
     biosumm[20,4]     <-  round((biosumm[13,4] + biosumm[14,4] + biosumm[15,4])/ 3, 2)
     biosumm[20,5]     <-  round((biosumm[13,5] + biosumm[14,5] + biosumm[15,5])/ 3, 0)
     biosumm[20,6]     <-  round((biosumm[13,6] + biosumm[14,6] + biosumm[15,6])/ 3, 0)  
     biosumm[20,7]     <-  round((biosumm[13,7] + biosumm[14,7] + biosumm[15,7])/ 3, 0)
      
     newdata           <-  rbind(biosumm[1:3,],   biosumm[16,], biosumm[4:6,],  biosumm[17,],
                                 biosumm[7:9,],   biosumm[18,], biosumm[10:12,],biosumm[19,], 
                                 biosumm[13:15,], biosumm[20,])   # r bind the average column results
     newdata$Spatial   <-  cleanf(newdata$Spatial)
     colnames(newdata) <-  c("Spatial","Depth","Males","Females","Males","Females","Tagged")
     a <-"the spatial strata S~1~, S~2~, S~3~, S~4~ and S~5~"
     
     pdiffS1 <- biosumm[16,3] - biosumm[16,4]  # --  S1 check male - female prop
     pS1     <- sum(pdiffS1 < 0.00)
     if (pS1 == 1)  {wS1="S~1~, "} else {wS1=""} # --  if value negative, more females
      
     pdiffS2 <- biosumm[17,3] - biosumm[17,4]  #  -- S2 check male - female prop
     pS2 <- sum(pdiffS2 < 0.00)
     if (pS2 == 1)  {wS2="S~2~, "} else {wS2=""} 
      
     pdiffS3 <- biosumm[18,3] - biosumm[18,4]   # --  S3 check male - female prop
     pS3 <- sum(pdiffS3 < 0.00)
     if (pS3 == 1)  {wS3="S~3~, "} else {wS3=""}
      
     pdiffS4 <- biosumm[19,3] - biosumm[19,4]  # -- S4 check male - female prop
     pS4 <- sum(pdiffS4 < 0.00)
     if (pS4 == 1)  {wS4="S~4~, "} else {wS4=""}
      
     pdiffS5 <- biosumm[20,3] - biosumm[20,4]  # -- S4 check male - female prop
     pS5 <- sum(pdiffS5 < 0.00)
     if (pS5 == 1)  {wS5="S~5~, "} else {wS5=""}
      
     stratafem    <- paste(wS1,wS2,wS3,wS4,wS5,sep="")         # -- list of S areas where more females
     stratafema   <- substr(stratafem, 1, nchar(stratafem)-2)  # -- trim trailing comma
     stratafemale <- sub(",([^,]*)$", " and\\1", stratafema)   # -- replace last comma with and
     stratafemale <- paste('the spatial strata ',stratafemale, sep="")
     if(stratafemale==a){stratafemale="all spatial strata"}

     #  More females than males were seen in the shallow depth stratum as per yearly trend...
     shallS1 <- sum((biosumm[1,3] - biosumm[1,4])<0.00)
     
     if (shallS1 == 1)  {shallwS1="S~1~, "} else {shallwS1=""}
           shallS2 <- sum((biosumm[4,3] - biosumm[4,4])<0.00)
           
     if (shallS2 == 1)  {shallwS2="S~2~, "} else {shallwS2=""}
           shallS3 <- sum((biosumm[7,3] - biosumm[7,4])<0.00)
            
     if (shallS3 == 1)  {shallwS3="S~3~, "} else {shallwS3=""}      
           shallS4 <- sum((biosumm[10,3] - biosumm[10,4])<0.00)
            
     if (shallS4 == 1)  {shallwS4="S~4~, "} else {shallwS4=""}  
           shallS5 <- sum((biosumm[13,3] - biosumm[13,4])<0.00)
            
     if (shallS5 == 1)  {shallwS5="S~5~, "} else {shallwS5=""}
            
     shallsfem    <- paste(shallwS1,shallwS2,shallwS3,shallwS4,shallwS5,sep="")
     shallsfema   <- substr(shallsfem, 1, nchar(shallsfem)-2)  # -- trim trailing comma
     shallsfemale <- sub(",([^,]*)$", " and\\1", shallsfema)   # replace last comma with and
     shallsfemale <- paste('the spatial strata ',shallsfemale, sep="") 
     if(shallsfemale==a){shallsfemale="all spatial strata"}
     
     # -- Assumption that more males than females were seen in the mid depth stratum
     midS1 <- sum((biosumm[2,3] - biosumm[2,4])>0.00)
      
      if (midS1 == 1)  {midwS1="S~1~, "} else {midwS1=""}
          midS2 <- sum((biosumm[5,3] - biosumm[5,4])>0.00)
      
      if (midS2 == 1)  {midwS2="S~2~, "} else {midwS2=""}
            midS3 <- sum((biosumm[8,3] - biosumm[8,4])>0.00)
      
      if (midS3 == 1)  {midwS3="S~3~, "} else {midwS3=""}      
          midS4 <- sum((biosumm[11,3] - biosumm[11,4])>0.00)
      
      if (midS4 == 1)  {midwS4="S~4~, "} else {midwS4=""}  
            midS5 <- sum((biosumm[14,3] - biosumm[14,4])>0.00)
      
      if (midS5 == 1)  {midwS5="S~5~, "} else {midwS5=""}
            
      midsm    <- paste(midwS1,midwS2,midwS3,midwS4,midwS5,sep="")
      midsma   <- substr(midsm, 1, nchar(midsm)-2)      # -- trim trailing comma
      midsmale <- sub(",([^,]*)$", " and\\1", midsma)   # -- replace last comma with and
      
      # -- Assumption that more females than males were seen in the deep depth stratum
      deepS1 <- sum((biosumm[3,3] - biosumm[3,4])<0.00)
      if (deepS1 == 1)  {deepwS1="S~1~, "} else {deepwS1=""}
      deepS2 <- sum((biosumm[6,3] - biosumm[6,4])<0.00)
      if (deepS2 == 1)  {deepwS2="S~2~, "} else {deepwS2=""}
      deepS3 <- sum((biosumm[9,3] - biosumm[9,4])<0.00)
      if (deepS3 == 1)  {deepwS3="S~3~, "} else {deepwS3=""}      
      deepS4 <- sum((biosumm[12,3] - biosumm[12,4])<0.00)
      if (deepS4 == 1)  {deepwS4="S~4~, "} else {deepwS4=""}  
      deepS5 <- sum((biosumm[15,3] - biosumm[15,4])<0.00)
      if (deepS5 == 1)  {deepwS5="S~5~, "} else {deepwS5=""}
      deepsfem    <- paste(deepwS1,deepwS2,deepwS3,deepwS4,deepwS5,sep="")
      deepsfema   <- substr(deepsfem, 1, nchar(deepsfem)-2)   # trim trailing comma
      deepsfemale <- sub(",([^,]*)$", " and\\1", deepsfema)   # replace last comma with and
 
  #  note that 2 re-releases have unknown length  total is 154 + 1 dead for 2012, one tag missing from GFBio : 73190	129	A00228975	A00181509
```
## SABLEFISH SAMPLING

A detailed breakdown of the fate of the catch in each trap for the `r yr` survey is listed in Appendix \@ref(app:fifth-appendix). 

In the StRS portion of the survey, a total of `r format(countStRS[3,2], big.mark=",")` sablefish were caught.   Of that total, `r format(countStRS[3,5], big.mark=",")` were tagged and released and `r format(countStRS[3,7], big.mark=",")` were retained for biological sampling. Of the tagged fish, `r countStRS[3,3]` were previously tagged fish that were re-released with a new tag.  In addition, one previously tagged fish was retained for sampling (Appendix \@ref(app:sixth-appendix)).

During the inlet standardized portion of the survey, a total of `r format(countStRS[1,2], big.mark=",")` sablefish were caught.  Of that total, `r format(countStRS[1,5], big.mark=",")` were tagged and released and `r format(countStRS[1,7], big.mark=",")` were retained for biological sampling. Of the tagged fish, `r countStRS[1,3]` were previously tagged fish that were re-released with a new tag (Appendix \@ref(app:sixth-appendix)).

One sablefish was caught on camera set 26 but not sampled (Table \@ref(tab:table5)).  One sablefish was caught on experimental set 43 and retained for biological sampling (Appendix \@ref(app:sixth-appendix)).

Overall, the StRS sets had a higher proportion of females than males over `r stratafemale` (Table \@ref(tab:table6)).  More females than males were seen in the shallow depth stratum within `r shallsfemale`.  In the mid depth stratum, there were more males than females in `r midsmale`.  The deepest depth stratum saw more females in spatial strata `r deepsfemale`.

Significant differences in length distributions between female and male sablefish are exhibited in the data collected from the StRS portion of the 2003 - `r yr+1` surveys. The mean fork length ($\bar{x}$) for the  `r format(tf, big.mark=",") ` females was `r mLf` cm and the mean fork length ($\bar{x}$) for the `r format(tm, big.mark=",")` males was `r mLm` cm (Figure \@ref(fig:figure11),a). 

In `r yr`, the mean fork length for the `r format(length(firstyrfem$sex), big.mark=",")` females was `r mean(females)` cm  and the mean fork length for the `r format(length(firstyrmal$sex), big.mark=",")` males was `r round(mavgyr1$AvL,1) ` cm (Figure \@ref(fig:figure11),b). 

On average, female sablefish grow faster and reach a far greater size (Figure \@ref(fig:figure12),a) compared to males (Figure \@ref(fig:figure12),b).

```{r rebsWords, echo=FALSE}

   # total counts of re/bs collected
   rougheye.yr <-  read.csv(paste(path,'appendixG.csv',sep=''),header=T)

   # count the guesses
   counter.rebs   <- paste("SELECT  year, COUNT(DISTINCT SPECIMEN_ID) AS Expr1, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM  (SELECT  year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                          "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM  dbo.gfbio_species_guess ",
                          "WHERE  (year = 2012) AND (EXISTENCE_ATTRIBUTE_DESC LIKE '%user guess%')) AS grp ",
                          "GROUP BY year, EXISTENCE_ATTRIBUTE_DESC",sep="")
    #count.rebs.guess.word   <- GetSQLData(counter.rebs,"Sablefish")
    #write.table(count.rebs.guess.word, file = paste(path,"results04b.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.rebs.guess.word   <-  read.csv(paste(path,'results04b.csv',sep=''),header=T)   


    # inline text query for bs/re
    count.rebs   <- paste("SELECT  COUNT(DISTINCT SPECIMEN_ID) AS CountREBS ",
                         "FROM    (SELECT year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                         "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                         "FROM            dbo.gfbio_species_guess ",
                         "WHERE        (year = ", yr,")) AS rebsgrp ",sep="")
    #count.rebs.word   <- GetSQLData(count.rebs,"Sablefish")
    #write.table(count.rebs.word, file = paste(path,"results04c.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.rebs.word   <-  read.csv(paste(path,'results04c.csv',sep=''),header=T)
    
    count.failure     <-paste("select COUNT(DISTINCT SPECIMEN_ID) AS failure  ",
                         "FROM (SELECT  year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                         "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM dbo.gfbio_species_guess ",
                          "WHERE   (year = ", yr,") AND (EXISTENCE_ATTRIBUTE_CODE IN (22))) AS rebsgrp",sep="")  #resolved genetic id
    #count.failure.word   <- GetSQLData(count.failure ,"Sablefish")
    #write.table(count.failure.word, file = paste(path,"results04d.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.failure.word   <-  read.csv(paste(path,'results04d.csv',sep=''),header=T) 
    
    # DNA analysis, always double check these numbers    
    count.bs     <-paste("select COUNT(DISTINCT SPECIMEN_ID) AS bs ",
                         "FROM (SELECT  year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                         "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM dbo.gfbio_species_guess ",
                          "WHERE   (year = ", yr,") AND (EXISTENCE_ATTRIBUTE_CODE IN (18))) AS rebsgrp",sep="")
    #count.bs.word   <- GetSQLData(count.bs,"Sablefish")
    #write.table(count.bs.word, file = paste(path,"results04e.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.bs.word   <-  read.csv(paste(path,'results04e.csv',sep=''),header=T)   
    
    count.hybrid     <-paste("select COUNT(DISTINCT SPECIMEN_ID) AS hybrid ",
                         "FROM (SELECT  year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                         "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM dbo.gfbio_species_guess ",
                          "WHERE   (year = ", yr,") AND (EXISTENCE_ATTRIBUTE_CODE IN (20,21))) AS rebsgrp",sep="")
    #count.hybrid.word   <- GetSQLData(count.hybrid ,"Sablefish")
    #write.table(count.hybrid.word, file = paste(path,"results04f.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.hybrid.word   <-  read.csv(paste(path,'results04f.csv',sep=''),header=T)   
    
    count.re     <-paste("select COUNT(DISTINCT SPECIMEN_ID) AS re ",
                         "FROM (SELECT  year, TRIP_ID, FE_MAJOR_LEVEL_ID, SPECIES_CODE, SPECIES_COMMON_NAME, ",
                         "EXISTENCE_ATTRIBUTE_CODE, SPECIMEN_ID, EXISTENCE_ATTRIBUTE_DESC ",
                          "FROM dbo.gfbio_species_guess ",
                          "WHERE   (year = ", yr,") AND (EXISTENCE_ATTRIBUTE_CODE IN (19))) AS rebsgrp",sep="")  #resolved genetic id
    #count.re.word   <- GetSQLData(count.re,"Sablefish")
    #write.table(count.re.word, file = paste(path,"results04g.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    count.re.word   <-  read.csv(paste(path,'results04g.csv',sep=''),header=T) 
    


```

## OTHER FISH SAMPLING

In `r yr`, length, sex, maturity, otoliths and DNA samples were collected for rougheye/blackspotted rockfish. Of the `r sum(rougheye.yr$DNA.Sample.Count)` DNA samples, `r count.rebs.guess.word[1,2]` were visually determined as blackspotted rockfish and `r count.rebs.guess.word[2,2]` as rougheye rockfish (Appendix \@ref(app:seventh-appendix)).  DNA analysis reveal that `r count.bs.word[1,1]` had a genetic id of blackspotted rockfish, `r count.re.word[1,1]` were determined to be rougheye rockfish, `r count.hybrid.word[1,1]` were designated as hybrid species and `r count.failure.word[1,1]` were unsuccessful.

Fork length and sex were collected for arrowtooth flounder (*Atheresthes stomias*),  aurora rockfish (*Sebastes aurora*), greenstriped rockfish (*Sebastes elongatus*), lingcod (*Ophiodon elongatus*), Pacific cod (*Squalus acanthias*), Pacific halibut (*Hippoglossus stenolepis*), redbanded rockfish (*Sebastes babcocki*), rosethorn rockfish (*Sebastes helvomaculatus*), shortraker rockfish (*Sebastes borealis*), walleye pollock (*Theragra chalcogramma*), yelloweye rockfish (*Sebastes ruberrimus*) and yellowmouth rockfish (*Sebastes reedi*) (Appendix \@ref(app:eighth-appendix)). 

Pre-caudal length and sex were collected for the tagged North Pacific spiny dogfish (*Squalus acanthias*).  Snout to anal fin lengths and sex were collected for giant grenadier (*Albatrossia pectoralis*) and Pacific grenadier (*Coryphaenoides acrolepis*). Total length and sex were collected for dover sole (*Microstomus pacificus*), giant blobsculpin (*Psychrolutes phrictus*), longspine thornyhead (*Sebastolobus altivelis*), north Pacific spiny dogfish (second measurement), Pacific flatnose (*Antimora microlepis*), pink snailfish (*Paraliparis rosaceus*), and shortspine thornyhead (*Sebastolobus alascanus*) (Appendix \@ref(app:eighth-appendix)).

```{r SableRecovered, echo=FALSE}
      # use data from table 7
      tag.rec <-  read.csv(paste(path,'table7.csv',sep=''), header=T)
      
      tag.rec[is.na(tag.rec)] <- 0   # convert NA to zero in whole table
      tag.rec$YearGroups      <- as.character(tag.rec$YearGroups)  # change column to character
      tag.rec$YearGroups      <- gsub("Grp1.", "", tag.rec$YearGroups)
      tag.rec$YearGroups      <- gsub("Grp2.", "", tag.rec$YearGroups)
      tag.rec$YearGroups      <- gsub("Grp3.", "", tag.rec$YearGroups)  
      tag.rec$YearGroups      <- gsub("Grp4.", "", tag.rec$YearGroups)      
      tag.rec$Recoveries      <- as.numeric(rowSums(tag.rec[,2:8], na.rm=TRUE))
      
      ad.row <- c('Total Counts',sum(tag.rec$X.10.km),sum(tag.rec$X11.50.km),sum(tag.rec$X51.100.km),
                          sum(tag.rec$X101.250.km),sum(tag.rec$X251.500.km),sum(tag.rec$X501.1000.km),
                          sum(tag.rec$X.1000.km), sum(tag.rec$Recoveries) )
      tag.rec.percent <- rbind(tag.rec,ad.row)
      
      tag.10km  <- sum(tag.rec$X.10.km) / sum(tag.rec$Recoveries) * 100     
      tag.50km  <- round((sum(tag.rec$X.10.km) + sum(tag.rec$X11.50.km))/ sum(tag.rec$Recoveries) * 100,0)
      tag.100km <- (sum(tag.rec$X.10.km) + sum(tag.rec$X11.50.km) + sum(tag.rec$X51.100.km))/ sum(tag.rec$Recoveries) * 100
      
      liberty5yrs <-  round(as.numeric(tag.rec$Recoveries[1] + tag.rec$Recoveries[2] + tag.rec$Recoveries[3])/ as.numeric(tag.rec.percent[6,9]) * 100,0)
      

```

## RECOVERED TAGGED SABLEFISH

Of the `r countStRS[1,3] + countStRS[2,3] + countStRS[3,3] + countStRS[1,4] + countStRS[2,4] + countStRS[3,4]` Canadian tagged fish that were recovered on the survey, the majority (`r tag.50km`%) had travelled within 50 kilometers of the release site.  Most of these tagged fish (`r liberty5yrs`%) were recaptured within 5 years at liberty (Table \@ref(tab:table7)).  


## TAGGED NORTH PACIFIC SPINY DOGFISH
North Pacific spiny dogfish with a pre-caudal length greater than seventy centimetres were tagged and released with pop-off satellite tags (Table \@ref(tab:table8)) throughout the survey area (Figure \@ref(fig:figure2)).   


```{r SablefishAgesText, echo=FALSE}
   # -- provides values for inline text, important to know the last year of ages completed
   # -- sql server procedure:  procRReport_Survey_proportions_at_age which pulls age data from 
   # -- GFBIOSQL.dbo.b21_samples and b22_specimens
   age         <-  paste("select Female_Yr_Total,Age from Report_Survey_GFBIO_Age_MF_Prop where ", 
                         "SetType='StRS' and f=1 and Year=",yr,sep="")
   #agedat      <-  GetSQLData(age,"Sablefish")    # --  female age total and count of most aged text captions
   #write.table(agedat, file = paste(path,"results08.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   agedat      <-    read.csv(paste(path,'results08.csv',sep=''),header=T)
   
   oldageF     <-  paste('exec procRReport_Survey_oldAgeSable 2, ', yr, ' ', sep='')  # -- oldest female text caption
   #oldageFem   <-  GetSQLData(oldageF,"Sablefish")
   #write.table(oldageFem, file = paste(path,"results09.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")    
   oldageFem   <-    read.csv(paste(path,'results09.csv',sep=''),header=T)
   
   oldageM     <-  paste('exec procRReport_Survey_oldAgeSable 1, ', yr, ' ', sep='')  # -- oldest male text caption
   #oldageMale  <-  GetSQLData(oldageM,"sablefish") 
   #write.table(oldageMale, file = paste(path,"results10.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",")   
   oldageMale  <-    read.csv(paste(path,'results10.csv',sep=''),header=T) 
   
   oldFem      <-  oldageFem[1,2]                # -- oldest female age
   oldFemYr    <-  oldageFem[1,3]                # -- year captured
   oldMale     <-  oldageMale[1,2]               # -- oldest male age
   oldMaleYr   <-  oldageMale[1,3]               # -- year captured
   
   # print(paste("f:",oldageFem, ", m: ",oldageMale,sep=""))

```

## SABLEFISH AGES

The highest proportion of female ages in the StRS sets for 2003 through to 2010 were 3, 4, 5, 6, 7, 8, 9, 10 years of age, respectively.  Then, another cohort appeared in 2011 and 2012, showing up as 3 and 4 year olds (Figure \@ref(fig:figure13), a).

The highest proportion of male ages in StRS sets for 2003 through to 2012 were 3, 5, 5, 6, 8, 8, 8, 10, 12 and 4 years of age, respectively (Figure \@ref(fig:figure13), b). 

Up to `r yr`, the oldest female sablefish was `r oldFem` years of age, collected in `r oldFemYr` and the oldest male sablefish was `r oldMale` years old, documented in `r oldMaleYr`.


```{r SablefishOceanText, echo=FALSE}
     # back track, data from figure 19  
     sea.bird     <-  "select * from SEABIRD_AverageTempPerSet where depth_stratum in('RD1','RD2','RD3')"  
     #sea.bird.ridge    <-  GetSQLData(sea.bird,"Sablefish")   # read from SQL Server
     #write.table(sea.bird.ridge, file = paste(path,"figure15.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
     
     celcius  <-  read.csv(paste(path,'figure15.csv',sep=''),header=T) 
     celcius  <-  celcius[celcius$Year <= yr,]
     # View(celcius)
     celcius$depth_stratum  <-   trimws(celcius$depth_stratum)   # trim whitespace

     shallow.temp <- celcius[celcius$depth_stratum=="RD1",]
     mid.temp     <- celcius[celcius$depth_stratum=="RD2",]        
     deep.temp    <- celcius[celcius$depth_stratum=="RD3",]  
     
     # View(shallow.temp)
       
     celcius.max.sh    <-  max(shallow.temp$Avgtemp)   # shallow max temp and year
     celcius.max.shallow <- shallow.temp[ which(shallow.temp$Avgtemp==celcius.max.sh), ]
     
     celcius.min.sh    <-  min(shallow.temp$Avgtemp)  # shallow min temp and year
     celcius.min.shallow <-shallow.temp[ which(shallow.temp$Avgtemp==celcius.min.sh),]

     celcius.max.md    <-  max(mid.temp$Avgtemp) # mid max temp and year
     celcius.max.mid <-mid.temp[ which(mid.temp$Avgtemp==celcius.max.md), ]
     
     celcius.min.md    <-  min(mid.temp$Avgtemp)  # mid min temp and year
     celcius.min.mid <-mid.temp[ which(mid.temp$Avgtemp==celcius.min.md),]    
     
     celcius.max.dp    <-  max(deep.temp$Avgtemp)  # deep max temp and year
     celcius.max.deep <-deep.temp[ which(deep.temp$Avgtemp==celcius.max.dp ),]  
     
     celcius.min.dp    <-  min(deep.temp$Avgtemp)  # deep min temp and year
     celcius.min.deep <-deep.temp[ which(deep.temp$Avgtemp==celcius.min.dp ),]
     
     # View(celcius.max.shallow.yr)
     # View(celcius.max.mid.yr)
     # View(celcius.max.deep.yr)
     
     
```

```{r SablefishOceanText2, echo=FALSE}
     # table SEABIRD_ReportLinePlot created in the Sablefish.dbo.Build_Seabird_tables procedure

     sbe.set <-  read.csv(paste(path,'appendixD.csv', sep=''),header=T)
    
     whatTrap  <-  paste("select * from SEABIRD_ACCEL_byTrap where year in(",yr,") order by [set]",sep="")
     #whatTraps <-  GetSQLData(whatTrap ,"Sablefish")  # in order to be able to comment on which traps the sensors were placed
     #write.table(whatTraps, file = paste(path,'results23.csv',sep=''), row.names=FALSE, na="",col.names=TRUE,  sep=",")
     whatTraps <-   read.csv(paste(path,'results23.csv',sep=''),header=T)
     #  View(whatTraps)
     
    
``` 

## OCEANOGRAPHIC TEMPERATURES AND DEPTHS

SBE 39 recorder data was successfully collected from `r length(sbe.set$sbe.39[sbe.set$sbe.39=='x'])` sets  in `r yr` (Appendix \@ref(app:fourth-appendix)).  Co-plots of average temperatures and average depths by 1-degree latitude intervals from south-west Vancouver Island to northwest Haida Gwaii can be found in Figure \@ref(fig:figure14).  The `r yr` survey data exhibit a general trend of decreasing temperature with depth over latitude.

SBE 39 recorders have been placed on survey fishing sets since 2006. In the shallow waters, the lowest to highest average temperatures reported by set were `r round(celcius.min.shallow[1,5],2)` $^\circ$C  (`r celcius.min.shallow[1,1]`) to `r round(celcius.max.shallow[1,5],2)` $^\circ$C (`r celcius.max.shallow[1,1]`). In the mid-depth waters, the lowest to highest average temperatures reported by set were `r round(celcius.min.mid[1,5],2)` $^\circ$C (`r celcius.min.mid[1,1]`) to `r round(celcius.max.mid[1,5],2)` $^\circ$C (`r celcius.max.mid[1,1]`). In the deepest waters, the lowest to highest average temperatures reported by set were `r round(celcius.min.deep[1,5],2)` $^\circ$C (`r celcius.min.deep[1,1]`) to `r round(celcius.max.deep[1,5],2)`$^\circ$C (`r celcius.min.deep[1,1]`) (Figure \@ref(fig:figure15)).


## BENTHIC IMPACTS STUDY DATA COLLECTION

The Nuytco autonomous camera system gathered the pilot MP4 footage from various camera angles on sets 5, 6 and 26.  Accelerometer readings of g-force (m/s$^2$) were successfully collected from `r length(sbe.set$hobo[sbe.set$hobo=='x'])` sets to reveal trap movement in all directions (Appendix \@ref(app:fourth-appendix)).

## EARTHQUAKE EVENT

Canadaâ€™s strongest earthquake in more than 60 years hit Haida Gwaii on Saturday October 27, 2012 at 08:04 pm.  At that time, bottom sensors were on the seafloor and recorded the seismic activity of the 7.7 magnitude earthquake (Figure \@ref(fig:figure16)). 


```{r acknowledge, echo=FALSE}

    names      <-  paste(" select keyid, Association, year, Names from dbo.ReportSurvey_Acknowlegdements where year=", yr, sep="")
    #credits    <-  GetSQLData(names,"Sablefish")
    #write.table(credits, file = paste(path,"results13.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    credits    <-  read.csv(paste(path,'results13.csv',sep=''),header=T) 
    
```    
                                                                                                        
## ACKNOWLEDGEMENTS

The stock assessment survey and data report is the result of the collaborative efforts of many individuals.  Wild Canadian Sablefish has provided coordination and support of the annual Sablefish survey since 1994.  The scientific staff that conducted the `r yr` sablefish research charter included `r credits[1,4]` of Archipelago Marine Research Ltd (AMR) and `r credits[2,4]` of Fisheries and Oceans, Canada.  

A special thanks to the skipper and crew of the F/V `r boat`, whose efforts made the survey successful.  In `r yr`, the crew consisted of `r credits[3,4]`.


\clearpage


